; 煤矿瓦斯风险预测系统配置文件
; 版本: 1.0
; 最后更新: 2025-10-15
[Model]
# 模型存储目录
model_dir = models
# 算法选择：lightgbm 或 xgboost
algorithm = lightgbm
# 全量训练触发阈值（样本数）
full_train_threshold = 200
# 最小训练样本数
min_train_samples = 5
# 初始树数量（控制模型基础拟合能力，欠拟合可增大）
n_estimators = 120
# 增量训练每次增加的树数量（增量更新强度，不足可增大）
increment_estimators = 20
; LightGBM核心参数（影响模型拟合能力，重点调优项）
; 单棵树的最大叶子数（叶子节点数，欠拟合增大，过拟合减小）
num_leaves = 16
; 学习率（步长，过小收敛慢，过大易震荡，建议0.01-0.1）
learning_rate = 0.03
; L1正则化（抑制过拟合，值越大惩罚越强）
reg_alpha = 2.0
; L2正则化（抑制过拟合，值越大惩罚越强）
reg_lambda = 6.0
; ===== LightGBM 过拟合抑制（新增项）=====
; 最大深度（LightGBM同样支持；配合num_leaves限制复杂度）
max_depth = 6
; 每个叶子最小样本数（强烈建议：抑制记忆噪声/过拟合）
min_data_in_leaf = 30
; 特征采样比例（增加随机性，提升泛化）
feature_fraction = 0.8
; 样本采样比例（bagging）
bagging_fraction = 0.8
; 每隔多少轮进行一次bagging（>0时才生效）
bagging_freq = 1
; XGBoost核心参数
; 子采样比例（防止过拟合，典型值0.7-1.0）
subsample = 0.7
; 特征采样比例（防止过拟合，典型值0.7-1.0）
colsample_bytree = 0.7
;过拟合/欠拟合判断阈值（解决硬编码问题） +++
overfitting_threshold = 2.0
# 数据量充足时的欠拟合阈值
underfitting_large_threshold = 1.0
# 数据量较小时的欠拟合阈值
underfitting_small_threshold = 1.2

[ModelEval]
# 评估样本数量（从数据库读取最新 eval_size 条）,根据实际情况的样本数量级调整
eval_size = 25
# 评估集切分策略：latest | time_holdout
eval_split_mode = time_holdout
# 留出最近多少天作为评估集（time_holdout 生效时使用）
holdout_days = 3
# time_holdout 最少评估样本数，不足则自动回退为 latest
min_holdout_samples = 20
# 性能下降阈值（相对于基线的比例，例如 0.10 = 10%）
perf_drop_ratio = 0.3
# 连续多少次评估确认下降（用于去抖）
perf_window = 2
# 聚合权重（2个目标）
agg_weights = 1,1

[Features]
# 基础分类特征（用逗号分隔）
base_categorical = working_face,work_stage,roadway,roadway_id,borehole_id
# 基础数值特征（用逗号分隔）
base_numeric = distance_from_entrance,x_coord,y_coord,z_coord,coal_thickness,regional_measure_strength,drilling_depth,distance_to_face,face_advance_distance
# 预测目标特征（用逗号分隔），移除了,gas_analysis_index_dh2特征
target_features = drilling_cuttings_s,gas_emission_velocity_q
# 动态数据库字段映射（字段名:数据类型，用分号分隔）
dynamic_db_columns = measurement_date:DATE;work_stage:VARCHAR(20);advance_rate:FLOAT;coord_hash:VARCHAR(100);gas_emission_q_diff:FLOAT;drilling_cuttings_s_diff:FLOAT;gas_emission_velocity_q_diff:FLOAT

[SpatioTemporal]
# 坐标分桶精度：round(1)=0.1m；round(0)=1m
coord_round = 1
# 距采面距离分桶（m），建议1~2m；设置为0表示不分桶
distance_to_face_bucket = 2
# 历史统计分组策略：
# coord：仅按坐标分组（兼容旧逻辑）
# coord_distance：按坐标+距采面距离分组（推荐，避免工况混淆）
history_group_mode = coord_distance
history_seed_limit = 200
