; 煤矿瓦斯风险预测系统配置文件
; 版本: 1.0
; 最后更新: 2025-10-15
[Model]
# 模型存储目录
model_dir = models
# 算法选择：lightgbm 或 xgboost
algorithm = xgboost
# 全量训练触发阈值（样本数）
full_train_threshold = 50
# 最小训练样本数
min_train_samples = 5
# 初始树数量（控制模型基础拟合能力，欠拟合可增大）
n_estimators = 80
# 增量训练每次增加的树数量（增量更新强度，不足可增大）
increment_estimators = 20
; LightGBM核心参数（影响模型拟合能力，重点调优项）
; 单棵树的最大叶子数（叶子节点数，欠拟合增大，过拟合减小）
num_leaves = 63
; 学习率（步长，过小收敛慢，过大易震荡，建议0.01-0.1）
learning_rate = 0.05
; L1正则化（抑制过拟合，值越大惩罚越强）
reg_alpha = 0.8
; L2正则化（抑制过拟合，值越大惩罚越强）
reg_lambda = 1.5
; XGBoost核心参数
; 树的最大深度（控制模型复杂度，过拟合可减小）
max_depth = 3
; 子采样比例（防止过拟合，典型值0.7-1.0）
subsample = 0.7
; 特征采样比例（防止过拟合，典型值0.7-1.0）
colsample_bytree = 0.7
;过拟合/欠拟合判断阈值（解决硬编码问题） +++
overfitting_threshold = 2.0
# 数据量充足时的欠拟合阈值
underfitting_large_threshold = 1.0
# 数据量较小时的欠拟合阈值
underfitting_small_threshold = 1.2

[Database]
#数据库主机地址
host = localhost
#数据库端口
port = 3306
#数据库用户名
user = root
#数据库密码
password = 123456
#数据库名称
db_name = hhhz-dzrj
charset = utf8mb4

[Server]
#服务绑定地址（0.0.0.0允许外部访问）
host = 0.0.0.0
#服务端口
port = 5000
#是否开启调试模式（生产环境设为false);
debug = false

[ModelEval]
# 小数据量判断阈值（低于此值跳过性能检查）
small_data_threshold = 10
# 中等数据量判断阈值（放宽性能检查）
medium_data_threshold = 20
# 评估样本数量（从数据库读取最新 eval_size 条）,根据实际情况的样本数量级调整
eval_size = 50
# 性能下降阈值（相对于基线的比例，例如 0.10 = 10%）
perf_drop_ratio = 0.3
# 连续多少次评估确认下降（用于去抖）
perf_window = 2
# 聚合权重（四个目标）
agg_weights = 1,1,1

[Logging]
# 保留最近多少个备份
keep_backups = 10
# 最大训练记录数
max_training_records = 1000
# 是否显示详细控制台输出
verbose_console = true
# 日志级别（DEBUG/INFO/WARNING/ERROR）
log_level = INFO

[Features]
# 基础分类特征（用逗号分隔）
base_categorical = working_face,roadway,roadway_id
# 基础数值特征（用逗号分隔）
base_numeric = distance_from_entrance,x_coord,y_coord,z_coord,coal_thickness,regional_measure_strength,tunneling_speed,roadway_length,initial_gas_emission_strength,roadway_cross_section,coal_density,original_gas_content,residual_gas_content,measurement_date,depth_from_face,daily_advance,cumulative_advance,effective_exposure_distance
# 预测目标特征（用逗号分隔），移除了,gas_analysis_index_dh2特征
target_features = gas_emission_q,drilling_cuttings_s,gas_emission_velocity_q
# 动态数据库字段映射（字段名:数据类型，用分号分隔）
dynamic_db_columns = new_feature1:FLOAT;new_feature2:VARCHAR(100)

# ============ 20251218 新增：时空特征配置 ============
[SpatialFeatures]
# 是否启用空间特征提取
enable_spatial_features = true
# 空间邻居搜索半径（米）
spatial_radius = 15.0
# 最大邻居数量限制
max_neighbors = 10

[TemporalFeatures]
# 是否启用时间序列特征提取
enable_temporal_features = true
# 时间滞后天数（用于计算变化率等）
temporal_lag_days = 5
# 是否启用时间衰减特征
enable_time_decay = true
# 是否启用深度衰减特征
enable_depth_decay = true

[DecayFeatures]
# 深度衰减系数（每米衰减百分比，0.05表示5%）
depth_decay_coefficient = 0.05
# 时间衰减系数（每天衰减百分比，0.01表示1%）
time_decay_coefficient = 0.01
# 是否启用综合衰减特征
enable_total_decay = true

# 断层影响系数计算配置（参考煤矿安全文献《断层对瓦斯涌出影响的量化分析》）
[FaultParams]
# 基础影响系数（无断层时默认值）
base_strength = 0.5
# 距离衰减系数（距离越大，影响越小）
distance_decay = 0.8
# 断层类型权重（1=正断层，2=逆断层）
fault_type_weight_1 = 1.2
fault_type_weight_2 = 0.8
# 断距权重系数（断距越大，影响越大）
fault_height_weight = 0.15
# 断层长度权重系数（长度越大，影响越大）
fault_length_weight = 0.1
# 倾角权重系数（倾角90°时影响最大，0°最小）
inclination_weight = 0.01
# 最大影响距离（超过此距离，断层无影响）
max_influence_distance = 50.0


[RegionalMeasureParams]
# 吨煤钻孔量计算配置（替换原措施权重/修正系数）
# 默认煤密度（吨/立方米，参考煤矿常见值）
default_coal_density = 1.4
# 最小煤量阈值（避免除以零，单位：吨）
min_coal_quantity = 0.001
# 参考标准：《煤矿井下瓦斯抽采工程设计规范》（吨煤钻孔量≥0.05m/t为有效措施）

; --------------------------------------------------
; 回采进尺特征配置
; --------------------------------------------------
[MiningAdvance]
# 默认每日进尺（米/天），当数据中没有daily_advance字段时使用
default_daily_advance = 3.0
# 是否启用累计进尺特征
enable_cumulative_advance = true
# 是否启用有效暴露距离特征
enable_effective_exposure = true
# 进尺数据可靠性阈值（天），超过此天数未采集数据，视为数据中断
advance_data_gap_threshold = 3